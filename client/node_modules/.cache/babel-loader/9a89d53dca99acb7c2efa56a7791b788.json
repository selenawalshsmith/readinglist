{"ast":null,"code":"var _jsxFileName = \"/Users/selena/readinglist/client/src/components/UserHome.js\";\nimport React, { Component, KeyboardEvent } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport BookGrid from \"./grid/BookGrid\";\nimport BookCard from \"./grid/BookCard\";\nimport Search from \"./Search\";\nimport getBooks from \"./../actions/getBooks\";\nimport ShowBooks from \"./ShowBooks\";\nimport { isEmpty } from 'lodash';\nimport jwt_decode from \"jwt-decode\"; //import setAuthToken from \"./actions/setAuthToken\";\n\n/*\nfunction IsLoading(props){\n  const isLoading = props.isLoading;\n  if (isLoading){\n    return <h1>Loading...</h1>\n  }\n  return 0;\n}\n*/\n\nclass UserHome extends Component {\n  constructor(props) {\n    super(props);\n\n    this.loadBooks = email => {\n      axios.post(\"/api/users/getBookList\", {\n        email: email\n      }).then(response => {\n        //console.log(response.data.booklist);\n        const bookList = response.data.booklist;\n        const books = [];\n\n        for (let i = 0; i < bookList.length; i++) {\n          const bookItem = {\n            id: bookList[i].id,\n            //how I will save users books in db.\n            title: bookList[i].title,\n            author: bookList[i].author,\n            description: bookList[i].description,\n            img: bookList[i].img\n          };\n          books.push(bookItem);\n        }\n\n        this.setState({\n          myBooks: books\n        });\n        this.setState({\n          isLoading: false\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.state = {\n      //user: ()=>{if(this.props.location.state.user == null){return this.props.user}else{return this.props.location.state.user; }},\n      //user: this.props.location.state.user,\n      user: this.props.user,\n      isLoading: true,\n      //jsonBookList: {},\n      //  myBooks: [book1, book2, book3] //this is an array of objects once populated\n      myBooks: []\n    };\n  }\n  /*\n  getUserName(pathname){\n    var path_arr = pathname.split(\"/\");\n    return path_arr[2];\n  }\n  */\n\n\n  getName() {\n    return this.state.user;\n  }\n\n  getUser() {\n    if (this.props.location.state.user == null) {\n      return this.props.user;\n    } else {\n      return this.props.location.state.user;\n    }\n  }\n\n  componentDidMount() {\n    //this.setState({user: this.props.user});\n    //console.log(this.props.user);\n    //console.log(this.props.location.state.user);\n    //  const userEmail = this.props.location.state.user;\n    //this.setState({user: userEmail});\n    //const userEmail = this.getUser();\n    //this.setState({user: userEmail});\n    //  this.loadBooks(this.state.user);\n    if (localStorage.jwtToken) {\n      // Set auth token header auth\n      const token = localStorage.jwtToken; //setAuthToken(token);\n      // Decode token and get user info and exp\n\n      const decoded = jwt_decode(token); // Set user and isAuthenticated\n      //setUser(decoded);\n      //console.log(decoded);\n      //App.setState({user: decoded});\n      //store.dispatch(setCurrentUser(decoded));\n      // Check for expired token\n\n      /*const currentTime = Date.now() / 1000; // to get in milliseconds\n      if (decoded.exp < currentTime) {\n        // Logout user\n        //logoutUser();\n        console.log(\"add logout action\");\n         // Redirect to login\n        window.location.href = \"./login\";\n      } else {*/\n\n      this.setState({\n        user: decoded.email\n      });\n      this.loadBooks(decoded.email); //console.log(this.state.user);\n      //console.log(decoded.email);\n      //return decoded.email;\n      //}\n    } else {\n      this.props.history.push(\"/login\");\n    }\n  }\n\n  render() {\n    //const myName = this.getName();\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }\n    }, \"Hello \", this.state.user), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ShowBooks, {\n      isLoading: this.state.isLoading,\n      myBooks: this.state.myBooks,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    })));\n  }\n\n}\n\n;\nexport default UserHome;","map":{"version":3,"sources":["/Users/selena/readinglist/client/src/components/UserHome.js"],"names":["React","Component","KeyboardEvent","axios","Link","BookGrid","BookCard","Search","getBooks","ShowBooks","isEmpty","jwt_decode","UserHome","constructor","props","loadBooks","email","post","then","response","bookList","data","booklist","books","i","length","bookItem","id","title","author","description","img","push","setState","myBooks","isLoading","catch","err","console","log","state","user","getName","getUser","location","componentDidMount","localStorage","jwtToken","token","decoded","history","render"],"mappings":"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","sourcesContent":["\nimport React, {Component,  KeyboardEvent}  from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport BookGrid from \"./grid/BookGrid\";\nimport BookCard from \"./grid/BookCard\";\nimport Search from \"./Search\";\nimport getBooks from \"./../actions/getBooks\";\nimport ShowBooks from \"./ShowBooks\";\nimport {isEmpty} from 'lodash';\n\nimport jwt_decode from \"jwt-decode\";\n//import setAuthToken from \"./actions/setAuthToken\";\n/*\nfunction IsLoading(props){\n  const isLoading = props.isLoading;\n  if (isLoading){\n    return <h1>Loading...</h1>\n  }\n  return 0;\n}\n*/\nclass UserHome extends Component{\n  constructor(props) {\n    super(props);\n    this.state= {\n      //user: ()=>{if(this.props.location.state.user == null){return this.props.user}else{return this.props.location.state.user; }},\n      //user: this.props.location.state.user,\n      user: this.props.user,\n      isLoading: true,\n      //jsonBookList: {},\n    //  myBooks: [book1, book2, book3] //this is an array of objects once populated\n      myBooks: []\n    }\n  }\n  /*\n  getUserName(pathname){\n    var path_arr = pathname.split(\"/\");\n    return path_arr[2];\n  }\n  */\n  getName(){\n    return this.state.user;\n  }\n  getUser(){\n    if(this.props.location.state.user == null){\n      return this.props.user\n    }else{\n      return this.props.location.state.user;\n    }\n  }\n  loadBooks = (email) => {\n    axios.post(\"/api/users/getBookList\", {email: email})\n    .then((response) => {\n      //console.log(response.data.booklist);\n      const bookList = response.data.booklist;\n      const books = [];\n      for (let i=0; i<bookList.length; i++){\n        const bookItem = {\n          id: bookList[i].id, //how I will save users books in db.\n          title: bookList[i].title,\n          author: bookList[i].author,\n          description: bookList[i].description,\n          img: bookList[i].img\n        }\n        books.push(bookItem);\n      }\n      this.setState({myBooks: books});\n      this.setState({isLoading: false});\n    }).catch(err => {console.log(err);});\n  };\n  componentDidMount(){\n    //this.setState({user: this.props.user});\n    //console.log(this.props.user);\n    //console.log(this.props.location.state.user);\n  //  const userEmail = this.props.location.state.user;\n    //this.setState({user: userEmail});\n    //const userEmail = this.getUser();\n    //this.setState({user: userEmail});\n\n  //  this.loadBooks(this.state.user);\n    if (localStorage.jwtToken) {\n      // Set auth token header auth\n      const token = localStorage.jwtToken;\n      //setAuthToken(token);\n      // Decode token and get user info and exp\n      const decoded = jwt_decode(token);\n      // Set user and isAuthenticated\n      //setUser(decoded);\n      //console.log(decoded);\n      //App.setState({user: decoded});\n      //store.dispatch(setCurrentUser(decoded));\n      // Check for expired token\n      /*const currentTime = Date.now() / 1000; // to get in milliseconds\n      if (decoded.exp < currentTime) {\n        // Logout user\n        //logoutUser();\n        console.log(\"add logout action\");\n\n        // Redirect to login\n        window.location.href = \"./login\";\n      } else {*/\n        this.setState({user: decoded.email});\n        this.loadBooks(decoded.email);\n        //console.log(this.state.user);\n        //console.log(decoded.email);\n        //return decoded.email;\n      //}\n    } else {\n      this.props.history.push(\"/login\");\n    }\n  }\n  render (){\n    //const myName = this.getName();\n\n    return (\n      <div>\n        <div>Hello {this.state.user}</div>\n        <div>\n        </div>\n        <div>\n        <ShowBooks isLoading={this.state.isLoading} myBooks={this.state.myBooks}/>\n        </div>\n      </div>\n    )\n  }\n};\nexport default UserHome;\n"]},"metadata":{},"sourceType":"module"}